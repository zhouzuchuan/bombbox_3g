/*
* git@github.com:zhouzuchuan/bombbox_3g.git
* https://github.com/zhouzuchuan/bombbox_3g
*/
"usr strict";!function(e,t){function r(t){if(this===e)return new r(t);this.options={selector:"zzc-bomb",currentClass:"current",bgClose:!1},this.info=[],this.backArr=[];for(var o in t)this.options[o]=t[o];this.init()}function o(e,t){return new RegExp("(^|\\s)"+e+"(\\s|$)").test(t.className)}function n(e,t){if(!o(e,t)){var r=t.className.split(" ");r.push(i(e)),t.className=r.join(" ")}}function c(e,t){if(o(e,t)){var r=new RegExp("(^|\\s)"+i(e)+"(\\s|$)","g");t.className=t.className.replace(r," ")}}function i(e){var t=/^\#|^\./,r=e;return t.test(e)&&(r=e.slice(1)),r}function s(e){var t;try{t=Array.prototype.slice.call(e)}catch(r){t=[];for(var o=0,n=e.length;n>o;o+=1)t.push(e[o])}finally{return t}}function a(e){var t;if("object"===l(e)){t={};for(var r in e)e[r].length&&(t[r]=e[r])}return t}function l(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}r.prototype={init:function(){function e(e){s(e).forEach(function(e,r){e.addEventListener("click",t,!1)})}var t=this,r=t.options,o=s(t._dealSelector().box);o.forEach(function(e,o){var n=e.getAttribute(r.selector);t.info[o]={trace:n,selector:t._dealSelector(n),current:!1}});var n=t._dealSelector();for(var c in n)e(n[c])},handleEvent:function(t){function r(e,t,r){s(e).forEach(function(e){if(e===i)switch(t){case"open":o._show(r);break;case"close":o._hide(r);break;case"back":o._hide(r,"back");break;default:if(!n.bgClose)return;o._hide(r)}})}var o=this,n=o.options,c=t||e.event,i=c.target||c.srcElement;c.stopPropagation(),o.info.forEach(function(e,t){for(var o in e.selector)r(e.selector[o],o,t)})},_dealSelector:function(){function e(){return t.querySelectorAll(arguments[0])}var r=this,o=r.options,n=arguments[0]?'="'+arguments[0]+'"':"";return{box:e("["+o.selector+n+"]"),close:e("["+o.selector+"-close "+n+"]"),back:e("["+o.selector+"-back "+n+"]"),open:e("["+o.selector+"-open"+n+"]")}},_hide:function(e){var t=this,r=this.options,o=t.info[e],n=o.selector.box[0];"function"===l(r.hideWill)&&r.hideWill.call(t,a(o.selector)),c(r.currentClass,n),o.current=!1,"back"===arguments[1]&&0!==t.backArr.length&&t._show(t.backArr.pop()),"function"===l(r.hideDid)&&r.hideDid.call(t,a(o.selector))},_show:function(e){var t=this,r=this.options,o=t.info[e],c=o.selector.box[0];t.info.forEach(function(e,r){e.current&&(t.backArr.forEach(function(e,o){e===r&&t.backArr.splice(o,1)}),t.backArr.push(r),e.current=!1,t._hide(r))}),"function"===l(r.showWill)&&r.showWill.call(t,a(o.selector)),n(r.currentClass,c),o.current=!0,"function"===l(r.showDid)&&r.showDid.call(t,a(o.selector))}},e.Bombbox=r}(window,document);